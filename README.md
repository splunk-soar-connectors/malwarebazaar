[comment]: # "Auto-generated SOAR connector documentation"
# MalwareBazaar

Publisher: Splunk  
Connector Version: 1.0.4  
Product Vendor: abuse.ch  
Product Name: MalwareBazaar  
Product Version Supported (regex): ".\*"  
Minimum Product Version: 5.2.0  

This app integrates with MalwareBazaar from abuse.ch to provide investigative actions

### Configuration Variables
The below configuration variables are required for this Connector to operate.  These variables are specified when configuring a MalwareBazaar asset in SOAR.

VARIABLE | REQUIRED | TYPE | DESCRIPTION
-------- | -------- | ---- | -----------
**base_url** |  required  | string | Base URL for MalwareBazaar
**api_key** |  optional  | password | API key from MalwareBazaar
**verify_server_cert** |  optional  | boolean | Verify Server Certificate

### Supported Actions  
[test connectivity](#action-test-connectivity) - Validate the asset configuration for connectivity using supplied configuration  
[get file info](#action-get-file-info) - Query the MalwareBazaar API for the corresponding hash  
[get file](#action-get-file) - Fetch malware sample from MalwareBazaar and store in vault  

## action: 'test connectivity'
Validate the asset configuration for connectivity using supplied configuration

Type: **test**  
Read only: **True**

#### Action Parameters
No parameters are required for this action

#### Action Output
No Output  

## action: 'get file info'
Query the MalwareBazaar API for the corresponding hash

Type: **investigate**  
Read only: **True**

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**hash** |  required  | You can check if a particular malware sample is known to MalwareBazaar by querying the API for this hash | string |  `hash`  `sha256`  `md5`  `sha1` 

#### Action Output
DATA PATH | TYPE | CONTAINS | EXAMPLE VALUES
--------- | ---- | -------- | --------------
action_result.parameter.hash | string |  `hash`  `sha256`  `md5`  `sha1`  |  
action_result.data.\*.comment | string |  |  
action_result.data.\*.file_name | string |  |  
action_result.data.\*.file_size | numeric |  |  
action_result.data.\*.file_type | string |  |  
action_result.data.\*.file_type_mime | string |  |  
action_result.data.\*.first_seen | string |  |  
action_result.data.\*.imphash | string |  |  
action_result.data.\*.last_seen | string |  |  
action_result.data.\*.md5_hash | string |  |  
action_result.data.\*.origin_country | string |  |  
action_result.data.\*.reporter | string |  |  
action_result.data.\*.sha1_hash | string |  |  
action_result.data.\*.signature | string |  |  
action_result.data.\*.tlsh | string |  |  
action_result.status | string |  |   success  failed 
action_result.message | string |  |  
action_result.summary | string |  |  
summary.total_objects | numeric |  |   1 
summary.total_objects_successful | numeric |  |   1   

## action: 'get file'
Fetch malware sample from MalwareBazaar and store in vault

Type: **investigate**  
Read only: **True**

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**hash** |  required  | SHA256 hash to fetch the file for | string |  `sha256`  `hash` 

#### Action Output
DATA PATH | TYPE | CONTAINS | EXAMPLE VALUES
--------- | ---- | -------- | --------------
action_result.parameter.hash | string |  `sha256`  `hash`  |  
action_result.data | string |  |  
action_result.status | string |  |   success  failed 
action_result.message | string |  |  
action_result.summary | string |  |  
summary.total_objects | numeric |  |   1 
summary.total_objects_successful | numeric |  |   1 